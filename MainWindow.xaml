<Window x:Class="biblioteka.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Научно-техническая библиотека"
        Height="680" Width="1100"
        WindowStartupLocation="CenterScreen"
        Background="#121212"
        FontFamily="Segoe UI, Inter">

    <Window.Resources>
        <!-- Цвета -->
        <SolidColorBrush x:Key="Primary" Color="#6C5CE7"/>
        <SolidColorBrush x:Key="Success" Color="#00B894"/>
        <SolidColorBrush x:Key="Danger" Color="#FF7675"/>
        <SolidColorBrush x:Key="Info" Color="#74B9FF"/>
        <SolidColorBrush x:Key="Purple" Color="#A29BFE"/>
        <SolidColorBrush x:Key="CardBg" Color="#1E1E1E"/>
        <SolidColorBrush x:Key="TextPrimary" Color="#FFFFFF"/>
        <SolidColorBrush x:Key="TextSecondary" Color="#B0B0B0"/>
        <SolidColorBrush x:Key="Border" Color="#333333"/>

        <!-- Стиль кнопок -->
        <Style TargetType="Button" x:Key="ActionButton">
            <Setter Property="Background" Value="{StaticResource CardBg}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="FontSize" Value="14"/>
            <Setter Property="Width" Value="160"/>
            <Setter Property="Height" Value="50"/>
            <Setter Property="Margin" Value="10"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="Cursor" Value="Hand"/>
            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="Button">
                        <Border x:Name="border"
                                Background="{TemplateBinding Background}"
                                CornerRadius="12"
                                BorderThickness="1"
                                BorderBrush="{StaticResource Border}">
                            <Grid>
                                <!-- Иконка слева -->
                                <TextBlock x:Name="icon"
                                           Text="{TemplateBinding Tag}"
                                           FontFamily="Segoe MDL2 Assets"
                                           FontSize="18"
                                           HorizontalAlignment="Left"
                                           VerticalAlignment="Center"
                                           Margin="6,0,0,0"
                                           Foreground="{StaticResource TextPrimary}"/>
                                <!-- Текст по центру -->
                                <ContentPresenter HorizontalAlignment="Center"
                                                  VerticalAlignment="Center"/>
                            </Grid>
                        </Border>
                        <ControlTemplate.Triggers>
                            <Trigger Property="IsMouseOver" Value="True">
                                <Setter TargetName="border" Property="Effect">
                                    <Setter.Value>
                                        <DropShadowEffect Color="#6C5CE7" ShadowDepth="0" BlurRadius="15" Opacity="0.6"/>
                                    </Setter.Value>
                                </Setter>
                            </Trigger>
                            <DataTrigger Binding="{Binding Content, RelativeSource={RelativeSource Self}}" Value="Добавить книгу">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource Success}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Content, RelativeSource={RelativeSource Self}}" Value="Удалить книгу">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource Danger}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Content, RelativeSource={RelativeSource Self}}" Value="Выдать книгу">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource Info}"/>
                            </DataTrigger>
                            <DataTrigger Binding="{Binding Content, RelativeSource={RelativeSource Self}}" Value="Читатели">
                                <Setter TargetName="border" Property="Background" Value="{StaticResource Purple}"/>
                            </DataTrigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>

        <!-- Стиль DataGrid -->
        <Style TargetType="DataGrid">
            <Setter Property="Background" Value="{StaticResource CardBg}"/>
            <Setter Property="Foreground" Value="{StaticResource TextPrimary}"/>
            <Setter Property="BorderBrush" Value="{StaticResource Border}"/>
            <Setter Property="GridLinesVisibility" Value="Horizontal"/>
            <Setter Property="HorizontalGridLinesBrush" Value="#2A2A2A"/>
            <Setter Property="RowBackground" Value="Transparent"/>
            <Setter Property="AlternatingRowBackground" Value="#252525"/>
            <Setter Property="FontSize" Value="13"/>
        </Style>

        <Style TargetType="DataGridColumnHeader">
            <Setter Property="Background" Value="#1A1A1A"/>
            <Setter Property="Foreground" Value="#AAAAAA"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Padding" Value="12,8"/>
            <Setter Property="BorderThickness" Value="0,0,0,1"/>
            <Setter Property="BorderBrush" Value="#333"/>
        </Style>

        <Style TargetType="DataGridRow">
            <Setter Property="Cursor" Value="Hand"/>
            <Style.Triggers>
                <Trigger Property="IsMouseOver" Value="True">
                    <Setter Property="Background" Value="#2D2D2D"/>
                </Trigger>
                <Trigger Property="IsSelected" Value="True">
                    <Setter Property="Background" Value="#3A3A3A"/>
                    <Setter Property="Foreground" Value="#FFFFFF"/>
                </Trigger>
            </Style.Triggers>
        </Style>

    </Window.Resources>

    <Grid Margin="25">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>

        <!-- Заголовок -->
        <TextBlock Text="Каталог книг"
                   Grid.Row="0"
                   FontSize="32"
                   FontWeight="Bold"
                   Foreground="{StaticResource Primary}"
                   HorizontalAlignment="Center"
                   Margin="0,0,0,20"/>

        <!-- Поиск -->
        <Grid Grid.Row="1" HorizontalAlignment="Center" Margin="0,0,0,25">
            <Border Background="{StaticResource CardBg}"
                    CornerRadius="12"
                    Padding="4"
                    BorderBrush="{StaticResource Border}"
                    BorderThickness="1"
                    Width="420">
                <Grid>
                    <TextBlock Text="Поиск"
                               FontSize="18"
                               Foreground="#888"
                               Margin="12,0,0,0"
                               VerticalAlignment="Center"/>
                    <TextBox x:Name="SearchBox"
                             Background="Transparent"
                             BorderThickness="0"
                             Foreground="{StaticResource TextPrimary}"
                             FontSize="15"
                             Padding="40,10,10,10"
                             TextChanged="SearchBox_TextChanged"
                             CaretBrush="#6C5CE7"
                             Tag="Поиск по названию, автору, разделу...">
                        <TextBox.Template>
                            <ControlTemplate TargetType="TextBox">
                                <Grid>
                                    <Border Background="{TemplateBinding Background}"
                                            BorderBrush="{TemplateBinding BorderBrush}"
                                            BorderThickness="{TemplateBinding BorderThickness}"/>
                                    <ScrollViewer x:Name="PART_ContentHost" Margin="{TemplateBinding Padding}"/>
                                    <TextBlock x:Name="Placeholder"
                                               Text="{Binding RelativeSource={RelativeSource TemplatedParent}, Path=Tag}"
                                               Foreground="#666"
                                               FontStyle="Italic"
                                               Margin="40,10,10,10"
                                               IsHitTestVisible="False"
                                               Opacity="0.7"
                                               Visibility="Collapsed"/>
                                </Grid>
                                <ControlTemplate.Triggers>
                                    <DataTrigger Binding="{Binding Text, RelativeSource={RelativeSource TemplatedParent}}" Value="">
                                        <Setter TargetName="Placeholder" Property="Visibility" Value="Visible"/>
                                    </DataTrigger>
                                    <Trigger Property="IsKeyboardFocused" Value="True">
                                        <Setter TargetName="Placeholder" Property="Visibility" Value="Collapsed"/>
                                    </Trigger>
                                </ControlTemplate.Triggers>
                            </ControlTemplate>
                        </TextBox.Template>
                    </TextBox>
                </Grid>
            </Border>
        </Grid>

        <!-- Кнопки -->
        <StackPanel Grid.Row="2"
                    Orientation="Horizontal"
                    HorizontalAlignment="Center"
                    Margin="0,0,0,25">
            <Button Content="Добавить книгу"
                    Click="AddBook_Click"
                    Style="{StaticResource ActionButton}"
                    Tag=""/>
            <Button Content="Удалить книгу"
                    Click="DeleteBook_Click"
                    Style="{StaticResource ActionButton}"
                    Tag=""/>
            <Button Content="Выдать книгу"
                    Click="IssueBook_Click"
                    Style="{StaticResource ActionButton}"
                    Tag=""/>
            <Button Content="Читатели"
                    Click="ViewReaders_Click"
                    Style="{StaticResource ActionButton}"
                    Tag=""/>
        </StackPanel>

        <!-- Таблица -->
        <Border Grid.Row="3"
                Background="{StaticResource CardBg}"
                CornerRadius="14"
                BorderBrush="{StaticResource Border}"
                BorderThickness="1"
                Padding="1">
            <DataGrid x:Name="BooksDataGrid"
                      AutoGenerateColumns="False"
                      CanUserAddRows="False"
                      IsReadOnly="True"
                      SelectionMode="Single"
                      SelectionUnit="FullRow"
                      MouseDoubleClick="BooksDataGrid_MouseDoubleClick"
                      ToolTip="Двойной клик — редактировать книгу">
                <DataGrid.Columns>
                    <DataGridTextColumn Header="ID" Binding="{Binding Identifier}" Width="70"/>
                    <DataGridTextColumn Header="Название" Binding="{Binding Title}" Width="2*"/>
                    <DataGridTextColumn Header="Авторы" Binding="{Binding Author}" Width="1.8*"/>
                    <DataGridTextColumn Header="Год" Binding="{Binding Yearr}" Width="80"/>
                    <DataGridTextColumn Header="Раздел" Binding="{Binding Razdel}" Width="130"/>
                    <DataGridTextColumn Header="Описание" Binding="{Binding Description}" Width="2*"/>
                    <DataGridTextColumn Header="Кол-во" Binding="{Binding Quantity}" Width="80"/>
                </DataGrid.Columns>
            </DataGrid>
        </Border>
    </Grid>
</Window>
